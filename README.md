# ブラウザ三国志向け全体マップ作成ツール

本ツールはブラウザ三国志の全体地図を作成するためのツールです。
遠征や戦争にご活用ください。

* 地図サンプル：https://dl.dropboxusercontent.com/u/48977850/bro3/histories/bro3_image_20141001_01.png

本ツールは、ブラウザ三国志beyondの「同盟員全領地座標csv」取得機能を使っていますが、このbeyondの機能はサーバーに負荷がかかるので、あまり頻繁に使わないようにしてください。

## 必要要件

* ブラウザ：firefox もしくは chrome
* ブラウザ三国志beyond（データ収集に使用します）

※ 本ツールはfirefoxでの使用を推奨しています。Chromeを使う場合は、起動時に「--allow-file-access-from-files」オプションを追加しないと動作しません

## 使い方

1. 右側の「Download ZIP」より本ツールをダウンロードして、zipファイルを解凍してください
2. 「data」フォルダの中にcsvファイル入れてください（csv作成方法は「CSVファイル作成方法について」を見てください）
3. 「src」フォルダの中にあるconfig.jsに「ファイル名と色の指定」という項目があるので、手順2で作成したcsvファイル名と色
4. bro3worldmap.htmlをブラウザにドラッグ＆ドロップしてください。地図が表示されます
5. 画像を右クリックして「名前をつけて画像を保存」を選択すると画像を保存することができます

### CSVファイル作成方法について

1. ブラウザ三国志beyondをインストールしてください
2. 全体マップに表示する同盟のトップページに移動してください
3. 同盟ページの下部に「同盟員全領地座標csv」というリンクから表示されるデータをコピーして、メモ帳などのテキストエディタにペーストしてください
4. メモ帳を使う場合は、「名前をつけて保存」から保存する際に「保存」ボタン左側の「文字コード」より「UTF-8」を選んでください

また、「data」フォルダの中には、mixi 17鯖の主要同盟のデータが入っています。必要なければ削除してください。

### config.jsの書き方

config.jsに「ファイル名と色の指定」という項目があるので、作成したcsvファイル名と色を指定してください。
a1同盟（赤、a1.csv）, a2同盟（青、a2.csv）, a3同盟（緑、a3.csv）がある場合は、以下のようになります。

    // ファイル名と色の指定
    var alliances = [
        ["a1.csv", "rgba(255, 0, 0, 1)"], 
        ["a2.csv", "rgba(0, 0, 255, 1)"], 
        ["a3.csv", "rgba(0, 255, 0, 1)"]
    ]

## 開発者向け

改造歓迎です。プルリクエストを送ってもらえたらもっと嬉しいです。

* URLパラメータ
  * 「manual=true」とつけると、csvファイルがなくても画像を作れるモードに切り替わります。デバッグ用にどうぞ
  * 「dev=true」をつけると、開発中の機能にアクセスできます。（現時点ではマップをクリックするとブラ三の地図に移動する機能のみ）

## 改善したいこと

* csvファイルがUTF-8というのは、一般ユーザーにとって間違えやすいと思うので、文字コードを問わないようにしたい
* 一般ユーザーがconfig.jsを書くのは難しいと思うので、もっと簡単な手段を準備したい
* 地図の拡大縮小
* 同盟一覧が左上固定なのは使いにくいので、動かせるようにしたい
